# 238. é™¤è‡ªèº«ä»¥å¤–æ•°ç»„çš„ä¹˜ç§¯

## ğŸ“ é¢˜ç›®æè¿°

ç»™ä½ ä¸€ä¸ªæ•´æ•°æ•°ç»„ `nums`ï¼Œè¿”å›æ•°ç»„ `answer`ï¼Œå…¶ä¸­ `answer[i]` ç­‰äº `nums` ä¸­é™¤ `nums[i]` ä¹‹å¤–å…¶ä½™å„å…ƒç´ çš„ä¹˜ç§¯ã€‚

é¢˜ç›®æ•°æ®ä¿è¯æ•°ç»„ `nums` ä¹‹ä¸­ä»»æ„å…ƒç´ çš„å…¨éƒ¨å‰ç¼€å…ƒç´ å’Œåç¼€å…ƒç´ çš„ä¹˜ç§¯éƒ½åœ¨ 32 ä½æ•´æ•°èŒƒå›´å†…ã€‚

**è¯·ä¸è¦ä½¿ç”¨é™¤æ³•**ï¼Œä¸”åœ¨ `O(n)` æ—¶é—´å¤æ‚åº¦å†…å®Œæˆæ­¤é¢˜ã€‚

**ç¤ºä¾‹ 1ï¼š**
```
è¾“å…¥ï¼šnums = [1,2,3,4]
è¾“å‡ºï¼š[24,12,8,6]
```

**ç¤ºä¾‹ 2ï¼š**
```
è¾“å…¥ï¼šnums = [-1,1,0,-3,3]
è¾“å‡ºï¼š[0,0,9,0,0]
```

**çº¦æŸæ¡ä»¶ï¼š**
- `2 <= nums.length <= 10^5`
- `-30 <= nums[i] <= 30`
- ä¿è¯æ•°ç»„ `nums` ä¹‹ä¸­ä»»æ„å…ƒç´ çš„å…¨éƒ¨å‰ç¼€å…ƒç´ å’Œåç¼€å…ƒç´ çš„ä¹˜ç§¯éƒ½åœ¨ 32 ä½æ•´æ•°èŒƒå›´å†…

**è¿›é˜¶**ï¼šä½ å¯ä»¥åœ¨ `O(1)` çš„é¢å¤–ç©ºé—´å¤æ‚åº¦å†…å®Œæˆè¿™ä¸ªé¢˜ç›®å—ï¼Ÿï¼ˆè¾“å‡ºæ•°ç»„ä¸è¢«è§†ä¸ºé¢å¤–ç©ºé—´ï¼‰

---

## â­ è§£æ³•ä¸€ï¼šå·¦å³ä¹˜ç§¯åˆ—è¡¨

### æ€è·¯

**æ ¸å¿ƒæ€æƒ³**ï¼šå¯¹äº `answer[i]`ï¼š
- **å·¦ä¾§ä¹˜ç§¯**ï¼š`nums[0] * nums[1] * ... * nums[i-1]`
- **å³ä¾§ä¹˜ç§¯**ï¼š`nums[i+1] * nums[i+2] * ... * nums[n-1]`
- **ç»“æœ**ï¼š`answer[i] = å·¦ä¾§ä¹˜ç§¯ * å³ä¾§ä¹˜ç§¯`

### ä»£ç å®ç°
```cpp
class Solution {
public:
    vector<int> productExceptSelf(vector<int>& nums) {
        int n = nums.size();
        vector<int> left(n), right(n), answer(n);
        
        // è®¡ç®—å·¦ä¾§ä¹˜ç§¯
        left[0] = 1;
        for (int i = 1; i < n; i++) {
            left[i] = left[i-1] * nums[i-1];
        }
        
        // è®¡ç®—å³ä¾§ä¹˜ç§¯
        right[n-1] = 1;
        for (int i = n-2; i >= 0; i--) {
            right[i] = right[i+1] * nums[i+1];
        }
        
        // è®¡ç®—ç­”æ¡ˆ
        for (int i = 0; i < n; i++) {
            answer[i] = left[i] * right[i];
        }
        
        return answer;
    }
};
```

### å¤æ‚åº¦åˆ†æ
- **æ—¶é—´å¤æ‚åº¦**ï¼šO(n)
- **ç©ºé—´å¤æ‚åº¦**ï¼šO(n)ï¼Œä½¿ç”¨äº† left å’Œ right æ•°ç»„

---

## ğŸš€ è§£æ³•äºŒï¼šç©ºé—´ä¼˜åŒ–ï¼ˆO(1)ç©ºé—´ï¼‰

### æ€è·¯

ä¸ä½¿ç”¨é¢å¤–çš„ left å’Œ right æ•°ç»„ï¼Œç›´æ¥åœ¨ answer æ•°ç»„ä¸Šæ“ä½œï¼š
1. å…ˆæ­£å‘éå†ï¼Œè®¡ç®—å·¦ä¾§ä¹˜ç§¯ï¼Œå­˜å…¥ answer
2. å†åå‘éå†ï¼Œè®¡ç®—å³ä¾§ä¹˜ç§¯ï¼ŒåŒæ—¶æ›´æ–° answer

### ä»£ç å®ç°
```cpp
class Solution {
public:
    vector<int> productExceptSelf(vector<int>& nums) {
        int n = nums.size();
        vector<int> answer(n);
        
        // ç¬¬ä¸€æ¬¡éå†ï¼šè®¡ç®—å·¦ä¾§ä¹˜ç§¯
        answer[0] = 1;
        for (int i = 1; i < n; i++) {
            answer[i] = answer[i-1] * nums[i-1];
        }
        
        // ç¬¬äºŒæ¬¡éå†ï¼šè®¡ç®—å³ä¾§ä¹˜ç§¯å¹¶æ›´æ–°ç­”æ¡ˆ
        int rightProduct = 1;
        for (int i = n-1; i >= 0; i--) {
            answer[i] *= rightProduct;
            rightProduct *= nums[i];
        }
        
        return answer;
    }
};
```

### å¤æ‚åº¦åˆ†æ
- **æ—¶é—´å¤æ‚åº¦**ï¼šO(n)
- **ç©ºé—´å¤æ‚åº¦**ï¼šO(1)ï¼Œä¸è®¡è¾“å‡ºæ•°ç»„

---

## ğŸ¯ æ ¸å¿ƒçŸ¥è¯†ç‚¹

### 1. å·¦å³ä¹˜ç§¯çš„å«ä¹‰

ä»¥ `nums = [1, 2, 3, 4]` ä¸ºä¾‹ï¼š

```
ç´¢å¼•:      0   1   2   3
nums:     [1,  2,  3,  4]

å·¦ä¾§ä¹˜ç§¯:
left[0] = 1           (æ²¡æœ‰å·¦ä¾§å…ƒç´ )
left[1] = 1           (1)
left[2] = 1*2 = 2     (1*2)
left[3] = 1*2*3 = 6   (1*2*3)

å³ä¾§ä¹˜ç§¯:
right[0] = 2*3*4 = 24 (2*3*4)
right[1] = 3*4 = 12   (3*4)
right[2] = 4          (4)
right[3] = 1          (æ²¡æœ‰å³ä¾§å…ƒç´ )

ç­”æ¡ˆ:
answer[0] = 1 * 24 = 24
answer[1] = 1 * 12 = 12
answer[2] = 2 * 4 = 8
answer[3] = 6 * 1 = 6
```

### 2. ç©ºé—´ä¼˜åŒ–æŠ€å·§

**å…³é”®è§‚å¯Ÿ**ï¼š
- left æ•°ç»„å¯ä»¥ç›´æ¥å­˜åœ¨ answer ä¸­
- right æ•°ç»„å¯ä»¥ç”¨ä¸€ä¸ªå˜é‡æ»šåŠ¨è®¡ç®—

```cpp
// ç¬¬ä¸€æ¬¡éå†å
answer = [1, 1, 2, 6]  // å­˜å‚¨å·¦ä¾§ä¹˜ç§¯

// ç¬¬äºŒæ¬¡éå†
i=3: answer[3] = 6 * 1 = 6, rightProduct = 4
i=2: answer[2] = 2 * 4 = 8, rightProduct = 12
i=1: answer[1] = 1 * 12 = 12, rightProduct = 24
i=0: answer[0] = 1 * 24 = 24, rightProduct = 24

// æœ€ç»ˆç­”æ¡ˆ
answer = [24, 12, 8, 6]
```

---

## ğŸ” å›¾è§£è¿‡ç¨‹ï¼ˆç©ºé—´ä¼˜åŒ–ç‰ˆï¼‰

```
nums = [1, 2, 3, 4]

ç¬¬ä¸€æ¬¡éå†ï¼ˆæ­£å‘ï¼‰ï¼šè®¡ç®—å·¦ä¾§ä¹˜ç§¯
i=0: answer[0] = 1
i=1: answer[1] = 1 * 1 = 1
i=2: answer[2] = 1 * 2 = 2
i=3: answer[3] = 2 * 3 = 6

answer = [1, 1, 2, 6]

ç¬¬äºŒæ¬¡éå†ï¼ˆåå‘ï¼‰ï¼šä¹˜ä¸Šå³ä¾§ä¹˜ç§¯
rightProduct = 1

i=3: answer[3] = 6 * 1 = 6
     rightProduct = 1 * 4 = 4

i=2: answer[2] = 2 * 4 = 8
     rightProduct = 4 * 3 = 12

i=1: answer[1] = 1 * 12 = 12
     rightProduct = 12 * 2 = 24

i=0: answer[0] = 1 * 24 = 24
     rightProduct = 24 * 1 = 24

æœ€ç»ˆï¼šanswer = [24, 12, 8, 6]
```

---

## ğŸ“ æ‰©å±•æ€è€ƒ

### ä¸ºä»€ä¹ˆä¸èƒ½ç”¨é™¤æ³•ï¼Ÿ

**å¦‚æœå…è®¸é™¤æ³•**ï¼š
```cpp
int totalProduct = 1;
for (int num : nums) {
    totalProduct *= num;
}
for (int i = 0; i < n; i++) {
    answer[i] = totalProduct / nums[i];
}
```

**é—®é¢˜**ï¼š
1. å¦‚æœ `nums[i] = 0`ï¼Œé™¤æ³•ä¼šå‡ºé”™
2. é¢˜ç›®è¦æ±‚ä¸ä½¿ç”¨é™¤æ³•

---

## ğŸ“Œ è®°å¿†è¦ç‚¹

- **æ€è·¯**ï¼šå·¦ä¾§ä¹˜ç§¯ Ã— å³ä¾§ä¹˜ç§¯
- **ä¼˜åŒ–**ï¼šç”¨ä¸€ä¸ªå˜é‡æ»šåŠ¨è®¡ç®—å³ä¾§ä¹˜ç§¯
- **å¤æ‚åº¦**ï¼šO(n) æ—¶é—´ï¼ŒO(1) ç©ºé—´
- **æŠ€å·§**ï¼šç¬¬ä¸€æ¬¡éå†å­˜å·¦ä¾§ï¼Œç¬¬äºŒæ¬¡éå†ä¹˜å³ä¾§

---

**æ ‡ç­¾**ï¼š`æ•°ç»„` `å‰ç¼€å’Œ` `medium`
